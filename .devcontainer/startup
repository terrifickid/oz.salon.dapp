#!/bin/bash

# Check if Python is available
if ! command -v python3 &> /dev/null; then
    echo "Error: Python3 is required but not installed."
    exit 1
fi

# Check if the secret exists
if [ -z "$SALON_APP_DEV" ]; then
    echo "Error: SALON_APP_DEV is not set"
    exit 1
fi

# Use Python to parse JSON and generate export commands
python3 -c "
import json, os
secret = json.loads(os.getenv('SALON_APP_DEV'))
for key, value in secret.items():
    print(f'export {key}=\"{value}\"')
" >> ~/.bashrc

# Source the bashrc to make variables available in current session
exec bash

echo "Environment variables set successfully"