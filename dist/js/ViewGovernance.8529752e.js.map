{"version":3,"file":"js/ViewGovernance.8529752e.js","mappings":"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","sources":["webpack://Salon/./src/components/AppFullpage.vue","webpack://Salon/./src/components/AppFullpage.vue?b4a0","webpack://Salon/./src/views/ViewGovernance.vue","webpack://Salon/./src/components/AppButtonVote.vue","webpack://Salon/./src/components/AppButtonVote.vue?f967","webpack://Salon/./src/components/CounterVote.vue","webpack://Salon/./src/components/CounterVote.vue?dad4","webpack://Salon/./src/views/ViewGovernance.vue?2954"],"sourcesContent":["<template>\n  <full-page ref=\"fullpage\" :options=\"options\" class=\"pr-16\">\n    <slot></slot>\n  </full-page>\n</template>\n<script>\nexport default {\n  data() {\n    return {\n      options: {\n        licenseKey: \"K9EP6-N164H-2BKM8-MJLGI-KSURM\",\n        controlArrows: true,\n        scrollBar: false,\n        scrollingSpeed: 500,\n        navigation: true,\n        navigationPosition: \"right\",\n      },\n    };\n  },\n  methods: {\n    async next() {\n      this.$refs.fullpage.api.moveSectionDown();\n    },\n    async resize() {\n      console.log(\"resize!\");\n      this.$refs.fullpage.api.fitToSection();\n      this.$refs.fullpage.api.reBuild();\n    },\n  },\n  mounted() {\n    console.log(\"mounted!\");\n  },\n  unmounted() {\n    window.removeEventListener(\"resize\", this.resize);\n  },\n};\n</script>\n<style>\n.fullpage-wrapper {\n  padding-right: 0 !important;\n}\n</style>\n","import { render } from \"./AppFullpage.vue?vue&type=template&id=f9d938ee\"\nimport script from \"./AppFullpage.vue?vue&type=script&lang=js\"\nexport * from \"./AppFullpage.vue?vue&type=script&lang=js\"\n\nimport \"./AppFullpage.vue?vue&type=style&index=0&id=f9d938ee&lang=css\"\n\nimport exportComponent from \"/Users/tk/oz.salon.dapp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n  <AppShell\n    :colors=\"colors\"\n    :isLoaded=\"loaded\"\n    :protected=\"true\"\n    class=\"font-haffer\"\n  >\n    <div\n      class=\"pt-24 text-center w-full absolute z-40 keyboard-off font-haffer\"\n    >\n      <select class=\"text-right p-2 font-bold\">\n        <option>Active</option>\n        <option>Completed</option>\n      </select>\n    </div>\n    <AppFullpage>\n      <div v-for=\"(item, index) in proposals\" :key=\"index\" class=\"section\">\n        <div class=\"grid grid-cols-12 w-full gap-3 px-3\" style=\"height: 50vh\">\n          <div class=\"col-span-6 sm:col-span-4 lg:col-span-3 xl:col-span-2\">\n            <b class=\"uppercase\">{{ item.contentType }}</b\n            ><br />\n            {{ item.id }}\n\n            <p class=\"mt-3\">\n              <AppButtonVote\n                :id=\"item.id\"\n                :votes=\"item.votes\"\n                :choice=\"true\"\n                :label=\"'Yes'\"\n                class=\"mr-2\"\n              />\n              <AppButtonVote\n                :id=\"item.id\"\n                :votes=\"item.votes\"\n                :choice=\"false\"\n                :label=\"'No'\"\n              />\n              <CounterVote :votes=\"item.votes\" />\n            </p>\n          </div>\n          <div class=\"col-span-6 sm:col-span-8 lg:col-span-9 xl:col-span-10\">\n            <div style=\"height: 50vh; overflow: scroll\">\n              <div style=\"height: 50vh; width: 100rem\">\n                <ul>\n                  <li\n                    v-for=\"(field, index) in item.fields\"\n                    :key=\"index\"\n                    class=\"inline-block mr-5 mb-5 text-sm\"\n                  >\n                    <b>{{ field.label }}</b\n                    ><br />{{ field.value }}\n                  </li>\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </AppFullpage>\n  </AppShell>\n</template>\n<script>\n// @ is an alias to /src\nimport axios from \"axios\";\nimport AppButtonVote from \"@/components/AppButtonVote\";\nimport CounterVote from \"@/components/CounterVote\";\nimport AppShell from \"@/components/AppShell\";\nimport AppFullpage from \"@/components/AppFullpage\";\n\nexport default {\n  components: { AppFullpage, AppShell, AppButtonVote, CounterVote },\n  data() {\n    return {\n      colors: [\"white\", \"black\"],\n      proposals: [],\n      types: [\"collect\", \"invest\", \"propose\", \"sell\", \"transfer\"],\n    };\n  },\n  computed: {\n    loaded() {\n      return this.proposals.length;\n    },\n  },\n  methods: {\n    getFieldLabel(fields, id) {\n      for (let field of fields) {\n        if (field.id == id) return field.name;\n      }\n    },\n    async assembleProposalType(type) {\n      var endpoints = [\n        \"https://salontest-terrifickid.cloud.okteto.net/type/\" + type,\n        \"https://salontest-terrifickid.cloud.okteto.net/form/\" + type,\n      ];\n      var scope = this;\n      try {\n        var items = [];\n        var e = await Promise.all(\n          endpoints.map((endpoint) => axios.get(endpoint))\n        );\n        for (const value of Object.values(e[0].data.message.items)) {\n          var votes = { votes: [] };\n          if (\"votes\" in value.fields) {\n            votes = value.fields.votes;\n            delete value.fields.votes;\n          }\n\n          var fields = await Object.entries(value.fields).map(function (field) {\n            var label = scope.getFieldLabel(e[1].data.fields, field[0]);\n            return {\n              label: label,\n              value: field[1],\n            };\n          });\n\n          var item = {\n            id: value.sys.id,\n            createdAt: value.sys.createdAt,\n            contentType: value.sys.contentType.sys.id,\n            votes: votes,\n            fields: fields,\n          };\n          items.push(item);\n        }\n\n        return items;\n      } catch (error) {\n        console.error(error);\n        return [];\n      }\n    },\n  },\n  async beforeMount() {\n    console.log(\"proposals load!\");\n    var data = await Promise.all(\n      this.types.map(async (type) => await this.assembleProposalType(type))\n    );\n\n    this.proposals = data.flat();\n    console.log(\"loaded!\");\n    console.log(this.proposals);\n  },\n};\n</script>\n<style scoped>\nselect {\n  border: 0px;\n  outline: 0px;\n}\n</style>\n","<template>\n  <AppButton @click=\"vote()\" :disabled=\"processing\">\n    {{ label }}\n    <svg\n      v-if=\"voted\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      class=\"h-6 w-6 ml-1\"\n      fill=\"none\"\n      viewBox=\"0 0 24 24\"\n      stroke=\"currentColor\"\n      stroke-width=\"2\"\n    >\n      <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M5 13l4 4L19 7\" />\n    </svg>\n  </AppButton>\n</template>\n<script>\nimport axios from \"axios\";\nimport AppButton from \"@/components/AppButton.vue\";\nexport default {\n  components: { AppButton },\n  props: [\"id\", \"votes\", \"choice\", \"label\"],\n  data() {\n    return {\n      processing: false,\n    };\n  },\n  computed: {\n    walletAddress() {\n      return this.$store.state.walletAddress;\n    },\n    voted() {\n      if (!this.votes) return false;\n      var voted = false;\n      if (\"en-US\" in this.votes) {\n        this.votes[\"en-US\"].votes.forEach((vote) => {\n          if (vote.address == this.walletAddress && vote.vote) voted = true;\n        });\n      }\n      return voted;\n    },\n  },\n  methods: {\n    async vote() {\n      const vote = JSON.stringify({\n        address: this.walletAddress,\n        vote: this.choice,\n        proposal: this.id,\n      });\n\n      //Sign Message and Vote\n      try {\n        const signature = await this.$store.state.signer.signMessage(vote);\n        console.log(\"Sending Vote!\");\n        const res = await axios.post(\n          \"https://salontest-terrifickid.cloud.okteto.net/vote/\" + this.id,\n          {\n            address: this.walletAddress,\n            vote: vote,\n            signature: signature,\n          }\n        );\n        console.log(res.data);\n        location.reload();\n      } catch (err) {\n        console.log(err);\n      }\n    },\n  },\n};\n</script>\n","import { render } from \"./AppButtonVote.vue?vue&type=template&id=4e38bbd0\"\nimport script from \"./AppButtonVote.vue?vue&type=script&lang=js\"\nexport * from \"./AppButtonVote.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/tk/oz.salon.dapp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n  <div>\n    <div>Total Votes: {{ total }}</div>\n    <div>Yes: {{ yesTotal }}</div>\n    <div>No: {{ noTotal }}</div>\n  </div>\n</template>\n<script>\nexport default {\n  props: [\"votes\"],\n  computed: {\n    total() {\n      return this.votes.votes.length;\n    },\n    yesTotal() {\n      return this.votes.votes.filter((vote) => {\n        var v = JSON.parse(vote.vote);\n        if (v.vote) return true;\n      }).length;\n    },\n    noTotal() {\n      return this.votes.votes.filter((vote) => {\n        var v = JSON.parse(vote.vote);\n        if (!v.vote) return true;\n      }).length;\n    },\n  },\n};\n</script>\n","import { render } from \"./CounterVote.vue?vue&type=template&id=758a4bd6\"\nimport script from \"./CounterVote.vue?vue&type=script&lang=js\"\nexport * from \"./CounterVote.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/tk/oz.salon.dapp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./ViewGovernance.vue?vue&type=template&id=d59b473a&scoped=true\"\nimport script from \"./ViewGovernance.vue?vue&type=script&lang=js\"\nexport * from \"./ViewGovernance.vue?vue&type=script&lang=js\"\n\nimport \"./ViewGovernance.vue?vue&type=style&index=0&id=d59b473a&scoped=true&lang=css\"\n\nimport exportComponent from \"/Users/tk/oz.salon.dapp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-d59b473a\"]])\n\nexport default __exports__"],"names":["ref","options","class","data","licenseKey","controlArrows","scrollBar","scrollingSpeed","navigation","navigationPosition","methods","async","this","$refs","fullpage","api","moveSectionDown","console","log","fitToSection","reBuild","mounted","unmounted","window","removeEventListener","resize","__exports__","render","style","colors","isLoaded","loaded","protected","proposals","item","index","key","contentType","id","votes","choice","label","fields","field","value","xmlns","fill","viewBox","stroke","d","vote","disabled","processing","components","AppButton","props","computed","walletAddress","$store","state","voted","forEach","address","JSON","stringify","proposal","signature","signer","signMessage","res","location","reload","err","total","yesTotal","noTotal","length","filter","v","parse","AppFullpage","AppShell","AppButtonVote","CounterVote","types","getFieldLabel","name","type","endpoints","scope","items","e","Promise","all","map","endpoint","Object","values","message","entries","sys","createdAt","push","error","assembleProposalType","flat"],"sourceRoot":""}