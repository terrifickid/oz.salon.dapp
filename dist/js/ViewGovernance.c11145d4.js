"use strict";(self["webpackChunkSalon"]=self["webpackChunkSalon"]||[]).push([[563],{1209:function(t,e,s){s.r(e),s.d(e,{default:function(){return F}});var o=s(6252);function n(t,e,s,n,l,r){const i=(0,o.up)("ListGovernance"),a=(0,o.up)("AppContent"),d=(0,o.up)("AppShell");return(0,o.wg)(),(0,o.j4)(d,{backgroundClass:"bg-white",textClass:"text-lilac",fillClass:"fill-lilac"},{default:(0,o.w5)((()=>[(0,o.Wm)(a,null,{default:(0,o.w5)((()=>[(0,o.Wm)(i,{class:"mt-16"})])),_:1})])),_:1})}var l=s(9141),r=s(5820),i=s(3577);const a={class:"grid grid-cols-12 w-full"},d={class:"col-span-12"},c={class:"col-span-4"},u={class:"text-3xl mb-8"},v={class:"col-span-4 flex justify-center"},p={class:"col-span-4"},h=["onClick"],w=(0,o._)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[(0,o._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17 8l4 4m0 0l-4 4m4-4H3"})],-1),g=(0,o.Uk)(" Execute "),f=[w,g];function k(t,e,s,n,l,r){const w=(0,o.up)("ButtonYes"),g=(0,o.up)("ButtonNo"),k=(0,o.up)("CounterVote");return(0,o.wg)(),(0,o.iD)("div",a,[(0,o._)("div",d,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.proposals,((t,e)=>((0,o.wg)(),(0,o.iD)("div",{class:"border-b mb-6 p-4 w-full grid grid-cols-12",key:e},[(0,o._)("div",c,[(0,o._)("p",u,(0,i.zw)(t.fields.proposalType["en-US"][0])+" #"+(0,i.zw)(t.sys.id),1),(0,o._)("p",null,(0,i.zw)(t),1)]),(0,o._)("div",v,[(0,o._)("div",null,[(0,o.Wm)(w,{id:t.sys.id,votes:t.fields.votes},null,8,["id","votes"]),(0,o.Wm)(g,{id:t.sys.id,votes:t.fields.votes},null,8,["id","votes"])])]),(0,o._)("div",p,[(0,o.Wm)(k,{votes:t.fields.votes},null,8,["votes"]),(0,o._)("button",{onClick:e=>r.execute(t.sys.id),class:"mt-2 text-pink flex"},f,8,h)])])))),128))])])}var m=s(9669),x=s.n(m);const y=["disabled"],_=(0,o.Uk)(" Yes "),b={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},C=(0,o._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"},null,-1),S=[C];function A(t,e,s,n,l,r){return(0,o.wg)(),(0,o.iD)("button",{onClick:e[0]||(e[0]=t=>r.yes()),disabled:t.processing,class:"mx-auto mt-3 bg-lilac text-white rounded px-4 py-3 text-xl shadow-sm op flex items-center w-32 justify-center"},[_,r.voted?((0,o.wg)(),(0,o.iD)("svg",b,S)):(0,o.kq)("",!0)],8,y)}var U={props:["id","votes"],computed:{profile(){return this.$store.state.profile},walletAddress(){return this.$store.state.walletAddress},voted(){if(!this.votes)return!1;var t=!1;return"en-US"in this.votes&&this.votes["en-US"].votes.forEach((e=>{e.address==this.walletAddress&&e.vote&&(t=!0)})),t}},methods:{async yes(){const t=JSON.stringify({address:this.walletAddress,vote:!0,proposal:this.id});try{const e=await this.$store.state.signer.signMessage(t);console.log("Sending Vote!");const s=await x().post("https://salontest-terrifickid.cloud.okteto.net/vote",{address:this.walletAddress,vote:t,signature:e});console.log(s.data),location.reload()}catch(e){console.log(e)}}}},D=s(3744);const j=(0,D.Z)(U,[["render",A]]);var B=j;const Z=(0,o.Uk)(" No "),$={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},z=(0,o._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"},null,-1),M=[z];function N(t,e,s,n,l,r){return(0,o.wg)(),(0,o.iD)("button",{onClick:e[0]||(e[0]=t=>r.no()),class:"mx-auto mt-3 bg-lilac text-white rounded px-4 py-3 text-xl shadow-sm op flex items-center w-32 justify-center"},[Z,r.voted?((0,o.wg)(),(0,o.iD)("svg",$,M)):(0,o.kq)("",!0)])}var T={props:["id","votes"],computed:{voted(){if(!this.votes)return!1;var t=!1;return"en-US"in this.votes&&this.votes["en-US"].votes.forEach((e=>{e.address!=this.$store.state.userAddress||e.vote||(t=!0)})),t}},methods:{async no(){const t=JSON.stringify({address:this.$store.state.userAddress,vote:!1,proposal:this.id});try{const e=await this.$store.state.signer.signMessage(t);console.log("Sending Vote!");const s=await x().post("https://salontest-terrifickid.cloud.okteto.net/vote",{address:this.$store.state.userAddress,vote:t,signature:e});console.log(s.data),location.reload()}catch(e){console.log(e)}}}};const L=(0,D.Z)(T,[["render",N]]);var V=L;function W(t,e,s,n,l,r){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",null,"Total Votes: "+(0,i.zw)(r.total),1),(0,o._)("div",null,"Yes: "+(0,i.zw)(r.yesTotal),1),(0,o._)("div",null,"No: "+(0,i.zw)(r.noTotal),1)])}var Y={props:["votes"],computed:{total(){return this.votes["en-US"].votes.length},yesTotal(){return this.votes["en-US"].votes.filter((t=>{if(t.vote)return!0})).length},noTotal(){return this.votes["en-US"].votes.filter((t=>{if(!t.vote)return!0})).length}}};const E=(0,D.Z)(Y,[["render",W]]);var G=E,O={components:{ButtonYes:B,ButtonNo:V,CounterVote:G},data(){return{proposals:[]}},methods:{async execute(t){console.log("execute!");try{const e=await x().post("https://salontest-terrifickid.cloud.okteto.net/execute",{id:t});console.log("executed!",e.data)}catch(e){console.log("error",e)}}},async beforeMount(){console.log("GLOad!");try{const t=await x().get("https://salontest-terrifickid.cloud.okteto.net/governance");this.proposals=t.data}catch(t){console.log("error",t)}}};const q=(0,D.Z)(O,[["render",k]]);var H=q,J={components:{AppShell:l.Z,ListGovernance:H,AppContent:r.Z}};const K=(0,D.Z)(J,[["render",n]]);var F=K}}]);
//# sourceMappingURL=ViewGovernance.c11145d4.js.map