"use strict";(self["webpackChunkSalon"]=self["webpackChunkSalon"]||[]).push([[563],{1677:function(e,t,o){o.d(t,{Z:function(){return i}});var s=o(6252);function l(e,t,o,l,n,a){const r=(0,s.up)("full-page");return(0,s.wg)(),(0,s.j4)(r,{ref:"fullpage",options:n.options,class:"pr-16"},{default:(0,s.w5)((()=>[(0,s.WI)(e.$slots,"default")])),_:3},8,["options"])}var n={data(){return{options:{licenseKey:"K9EP6-N164H-2BKM8-MJLGI-KSURM",controlArrows:!0,scrollBar:!1,scrollingSpeed:500,navigation:!0,navigationPosition:"right"}}},methods:{async next(){this.$refs.fullpage.api.moveSectionDown()},async resize(){console.log("resize!"),this.$refs.fullpage.api.fitToSection(),this.$refs.fullpage.api.reBuild()}},mounted(){console.log("mounted!")},unmounted(){window.removeEventListener("resize",this.resize)}},a=o(3744);const r=(0,a.Z)(n,[["render",l]]);var i=r},3514:function(e,t,o){o.r(t),o.d(t,{default:function(){return N}});var s=o(6252),l=o(3577);const n=e=>((0,s.dD)("data-v-68ebb60a"),e=e(),(0,s.Cn)(),e),a=n((()=>(0,s._)("div",{class:"pt-24 text-center w-full absolute z-40 keyboard-off font-haffer"},[(0,s._)("select",{class:"text-right p-2 font-bold"},[(0,s._)("option",null,"Active"),(0,s._)("option",null,"Completed")])],-1))),r={class:"grid grid-cols-12 w-full gap-3 px-3",style:{height:"50vh"}},i={class:"col-span-6 sm:col-span-4 lg:col-span-3 xl:col-span-2"},d={class:"uppercase"},c=n((()=>(0,s._)("br",null,null,-1))),p={class:"mt-3"},u={class:"col-span-6 sm:col-span-8 lg:col-span-9 xl:col-span-10"},v={style:{height:"50vh",overflow:"scroll"}},h={style:{height:"50vh",width:"100rem"}},f=n((()=>(0,s._)("br",null,null,-1)));function g(e,t,o,n,g,w){const m=(0,s.up)("AppButtonVote"),b=(0,s.up)("CounterVote"),y=(0,s.up)("AppFullpage"),k=(0,s.up)("AppShell");return(0,s.wg)(),(0,s.j4)(k,{colors:g.colors,isLoaded:w.loaded,protected:!0,class:"font-haffer"},{default:(0,s.w5)((()=>[a,(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(g.proposals,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{key:t,class:"section"},[(0,s._)("div",r,[(0,s._)("div",i,[(0,s._)("b",d,(0,l.zw)(e.contentType),1),c,(0,s.Uk)(" "+(0,l.zw)(e.id)+" ",1),(0,s._)("p",p,[(0,s.Wm)(m,{id:e.id,votes:e.votes,choice:!0,label:"Yes",class:"mr-2"},null,8,["id","votes"]),(0,s.Wm)(m,{id:e.id,votes:e.votes,choice:!1,label:"No"},null,8,["id","votes"]),(0,s.Wm)(b,{votes:e.votes},null,8,["votes"])])]),(0,s._)("div",u,[(0,s._)("div",v,[(0,s._)("div",h,[(0,s._)("ul",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.fields,((e,t)=>((0,s.wg)(),(0,s.iD)("li",{key:t,class:"inline-block mr-5 mb-5 text-sm"},[(0,s._)("b",null,(0,l.zw)(e.label),1),f,(0,s.Uk)((0,l.zw)(e.value),1)])))),128))])])])])])])))),128))])),_:1})])),_:1},8,["colors","isLoaded"])}var w=o(9669),m=o.n(w);const b={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},y=(0,s._)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"},null,-1),k=[y];function _(e,t,o,n,a,r){const i=(0,s.up)("AppButton");return(0,s.wg)(),(0,s.j4)(i,{onClick:t[0]||(t[0]=e=>r.vote()),disabled:a.processing},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(o.label)+" ",1),r.voted?((0,s.wg)(),(0,s.iD)("svg",b,k)):(0,s.kq)("",!0)])),_:1},8,["disabled"])}var A=o(7175),S={components:{AppButton:A.Z},props:["id","votes","choice","label"],data(){return{processing:!1}},computed:{walletAddress(){return this.$store.state.walletAddress},voted(){if(!this.votes)return!1;var e=!1;return"en-US"in this.votes&&this.votes["en-US"].votes.forEach((t=>{t.address==this.walletAddress&&t.vote&&(e=!0)})),e}},methods:{async vote(){const e=JSON.stringify({address:this.walletAddress,vote:this.choice,proposal:this.id});try{const t=await this.$store.state.signer.signMessage(e);console.log("Sending Vote!");const o=await m().post("https://salontest-terrifickid.cloud.okteto.net/vote/"+this.id,{address:this.walletAddress,vote:e,signature:t});console.log(o.data),location.reload()}catch(t){console.log(t)}}}},z=o(3744);const T=(0,z.Z)(S,[["render",_]]);var x=T;function B(e,t,o,n,a,r){return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",null,"Total Votes: "+(0,l.zw)(r.total),1),(0,s._)("div",null,"Yes: "+(0,l.zw)(r.yesTotal),1),(0,s._)("div",null,"No: "+(0,l.zw)(r.noTotal),1)])}var C={props:["votes"],computed:{total(){return this.votes.votes.length},yesTotal(){return this.votes.votes.filter((e=>{var t=JSON.parse(e.vote);if(t.vote)return!0})).length},noTotal(){return this.votes.votes.filter((e=>{var t=JSON.parse(e.vote);if(!t.vote)return!0})).length}}};const D=(0,z.Z)(C,[["render",B]]);var Z=D,L=o(542),j=o(1677),K={components:{AppFullpage:j.Z,AppShell:L.Z,AppButtonVote:x,CounterVote:Z},data(){return{colors:["white","black"],proposals:[],types:["invest"]}},computed:{loaded(){return this.proposals.length}},methods:{getFieldLabel(e,t){for(let o of e)if(o.id==t)return o.name},async assembleProposalType(e){var t=["https://salontest-terrifickid.cloud.okteto.net/type/"+e,"https://salontest-terrifickid.cloud.okteto.net/form/"+e],o=this;try{var s=[],l=await Promise.all(t.map((e=>m().get(e))));for(const e of Object.values(l[0].data.message.items)){var n={votes:[]};"votes"in e.fields&&(n=e.fields.votes,delete e.fields.votes);var a=await Object.entries(e.fields).map((function(e){var t=o.getFieldLabel(l[1].data.fields,e[0]);return{label:t,value:e[1]}})),r={id:e.sys.id,createdAt:e.sys.createdAt,contentType:e.sys.contentType.sys.id,votes:n,fields:a};s.push(r)}return s}catch(i){return console.error(i),[]}}},async beforeMount(){console.log("proposals load!");var e=await Promise.all(this.types.map((async e=>await this.assembleProposalType(e))));this.proposals=e.flat(),console.log("loaded!"),console.log(this.proposals)}};const M=(0,z.Z)(K,[["render",g],["__scopeId","data-v-68ebb60a"]]);var N=M}}]);
//# sourceMappingURL=ViewGovernance.1751b333.js.map